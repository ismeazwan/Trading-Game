<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle Tycoon Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .nav-button.active { background-color: #4B5563; }
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background-color: #22c55e;
            color: white;
            border-radius: 8px;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.5s, bottom 0.5s;
        }
        .toast.show {
            opacity: 1;
            bottom: 100px;
        }
        .card {
            background: linear-gradient(45deg, #3f3f46, #1f2937);
            border: 1px solid #52525b;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <div id="app" class="max-w-md sm:max-w-lg md:max-w-2xl mx-auto bg-gray-800 shadow-lg rounded-lg min-h-screen flex flex-col">
        <!-- Main Content -->
        <main class="flex-grow p-4">
            <div id="main-screen" class="screen">
                 <div class="bg-gray-700 p-4 rounded-lg mb-4">
                     <div class="flex justify-between items-center">
                         <div>
                             <p class="text-sm text-gray-400">Uang Tunai</p>
                             <p id="money" class="text-2xl font-bold">Rp 0</p>
                         </div>
                     </div>
                 </div>
                 <div class="flex justify-center items-center my-8">
                     <button id="click-button" class="bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold rounded-full w-40 h-40 flex flex-col justify-center items-center shadow-lg transition transform hover:scale-105">
                         <span class="text-3xl" id="click-value">Rp 100</span>
                         <span class="text-sm">KLIK</span>
                     </button>
                 </div>
            </div>

            <!-- Hub Bisnis -->
            <div id="business-hub-screen" class="screen hidden bg-gray-700 p-4 rounded-lg">
                <h2 class="text-xl font-bold mb-4 text-green-400">Manajemen Bisnis</h2>
                <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <p class="text-sm text-gray-400">Saldo Anda di Game Bisnis</p>
                    <p id="business-balance" class="text-2xl font-bold">Rp 0</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold mb-2">Deposit ke Game Bisnis</h3>
                        <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="deposit-amount-business" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah deposit">
                                <button id="deposit-max-business" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="deposit-button-business" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Deposit</button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-2">Tarik dari Game Bisnis</h3>
                         <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="withdraw-amount-business" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah penarikan">
                                <button id="withdraw-max-business" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="withdraw-button-business" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Tarik</button>
                        </div>
                    </div>
                </div>
                 <div class="mt-6 text-center">
                     <a href="game_bisnis.html" class="w-full block bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded">
                         Buka Game Bisnis
                     </a>
                 </div>
            </div>

            <!-- Hub Platform Lelang -->
            <div id="exchange-screen" class="screen hidden bg-gray-700 p-4 rounded-lg">
                 <h2 class="text-xl font-bold mb-4 text-purple-400">Platform Lelang</h2>
                <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <p class="text-sm text-gray-400">Saldo Anda di Lelang</p>
                    <p id="exchange-balance" class="text-2xl font-bold">Rp 0</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold mb-2">Deposit ke Lelang</h3>
                        <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="deposit-amount-exchange" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah deposit">
                                <button id="deposit-max-exchange" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="deposit-button-exchange" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Deposit</button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-2">Tarik dari Lelang</h3>
                         <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="withdraw-amount-exchange" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah penarikan">
                                <button id="withdraw-max-exchange" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="withdraw-button-exchange" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Tarik</button>
                        </div>
                    </div>
                </div>
                 <div class="mt-6 text-center">
                     <a href="lelang.html" class="w-full block bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded">
                         Buka Platform Lelang
                     </a>
                 </div>
            </div>
            
            <!-- Hub Trading Platform -->
             <div id="trading-screen" class="screen hidden bg-gray-700 p-4 rounded-lg">
                 <h2 class="text-xl font-bold mb-4 text-cyan-400">Platform Trading (Forex/Saham)</h2>
                <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <p class="text-sm text-gray-400">Saldo di Platform Trading</p>
                    <p id="trading-balance" class="text-2xl font-bold">Rp 0</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold mb-2">Deposit ke Platform Trading</h3>
                         <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="deposit-amount-trading" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah deposit">
                                <button id="deposit-max-trading" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="deposit-button-trading" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Deposit</button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-2">Tarik dari Platform Trading</h3>
                         <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="withdraw-amount-trading" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah penarikan">
                                <button id="withdraw-max-trading" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="withdraw-button-trading" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Tarik</button>
                        </div>
                    </div>
                </div>
                 <div class="mt-6 text-center">
                     <a href="trading_platform.html" class="w-full block bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded">
                         Buka Platform Trading
                     </a>
                 </div>
            </div>

            <!-- Hub Crypto Exchange -->
            <div id="crypto-screen" class="screen hidden bg-gray-700 p-4 rounded-lg">
                 <h2 class="text-xl font-bold mb-4 text-orange-400">Crypto Exchange</h2>
                <div class="bg-gray-800 p-4 rounded-lg mb-4">
                    <p class="text-sm text-gray-400">Saldo di Crypto Exchange</p>
                    <p id="crypto-balance" class="text-2xl font-bold">Rp 0</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold mb-2">Deposit ke Crypto Exchange</h3>
                         <div class="flex space-x-2">
                             <div class="relative w-full">
                                <input type="number" id="deposit-amount-crypto" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah deposit">
                                <button id="deposit-max-crypto" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="deposit-button-crypto" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Deposit</button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-2">Tarik dari Crypto Exchange</h3>
                         <div class="flex space-x-2">
                            <div class="relative w-full">
                                <input type="number" id="withdraw-amount-crypto" class="w-full bg-gray-900 p-2 rounded pr-12" placeholder="Jumlah penarikan">
                                <button id="withdraw-max-crypto" class="absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300">MAX</button>
                            </div>
                            <button id="withdraw-button-crypto" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Tarik</button>
                        </div>
                    </div>
                </div>
                 <div class="mt-6 text-center">
                     <a href="crypto_exchange.html" class="w-full block bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded">
                         Buka Crypto Exchange
                     </a>
                 </div>
            </div>
            
            <div id="shop-screen" class="screen hidden bg-gray-700 p-4 rounded-lg">
                 <h2 class="text-xl font-bold mb-4 text-yellow-400">Toko Upgrade</h2>
                 <p class="text-gray-400 mb-4">Beli upgrade berbatas waktu untuk meningkatkan progres game Anda di halaman Toko.</p>
                 <div class="mt-6 text-center">
                     <a href="shop.html" class="w-full block bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 px-4 rounded">
                         Buka Toko
                     </a>
                 </div>
            </div>

            <!-- Card Management Screen -->
            <div id="card-screen" class="screen hidden">
                <h2 class="text-xl font-bold mb-4 text-center">Manajemen Kartu & Bank</h2>
                <div class="bg-gray-700 p-4 rounded-lg mb-4 text-center">
                    <p class="text-sm text-gray-400">Total Uang di Bank</p>
                    <p id="total-in-bank" class="text-3xl font-bold text-cyan-400">Rp 0</p>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg mb-4">
                    <h3 class="font-semibold mb-2">Buat Kartu Bank Baru</h3>
                    <div class="flex space-x-2">
                        <input type="text" id="card-name-input" class="w-full bg-gray-900 p-2 rounded" placeholder="Nama Kartu (Contoh: Belanja)">
                        <button id="create-card-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded">Buat</button>
                    </div>
                </div>
                <div id="card-list" class="space-y-4">
                    <!-- Kartu yang dibuat akan muncul di sini -->
                </div>
            </div>
        </main>

        <!-- Navigation -->
        <nav class="bg-gray-900 p-2 grid grid-cols-7 gap-1 sticky bottom-0">
            <button class="nav-button p-1 rounded-lg flex flex-col items-center active" data-screen="main-screen">üè†<span class="text-xs">Utama</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="business-hub-screen">üè¢<span class="text-xs">Bisnis</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="exchange-screen">‚öñÔ∏è<span class="text-xs">Lelang</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="trading-screen">üìä<span class="text-xs">Trading</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="crypto-screen">ü™ô<span class="text-xs">Crypto</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="shop-screen">üõçÔ∏è<span class="text-xs">Toko</span></button>
            <button class="nav-button p-1 rounded-lg flex flex-col items-center" data-screen="card-screen">üí≥<span class="text-xs">Kartu</span></button>
        </nav>
    </div>
    <div id="toast-container"></div>

    <script>
    let money = 100000; // Represents cash on hand
    let bankData = { cards: [] };
    
    // Cache UI Elements
    const moneyEl = document.getElementById('money');
    const clickButton = document.getElementById('click-button');
    const clickValueEl = document.getElementById('click-value');
    
    // Card Screen elements
    const totalInBankEl = document.getElementById('total-in-bank');
    const cardListEl = document.getElementById('card-list');
    const createCardBtn = document.getElementById('create-card-btn');
    const cardNameInput = document.getElementById('card-name-input');
    
    // Hub Balance elements
    const businessBalanceEl = document.getElementById('business-balance');
    const exchangeBalanceEl = document.getElementById('exchange-balance');
    const tradingBalanceEl = document.getElementById('trading-balance');
    const cryptoBalanceEl = document.getElementById('crypto-balance');
    
    const suffixes = ['', 'Rb', 'Jt', 'M', 'T', 'Qa', 'Qi', 'Sx', 'Sp', 'Oc', 'No', 'Dc', 'Ud', 'Dd', 'Td', 'Qad', 'Qid', 'Sxd', 'Spd', 'Ocd', 'Nod', 'Vg', 'Uvg', 'Dvg', 'Tvg', 'Qavg', 'Qivg', 'Sxvg', 'Spvg', 'Ocvg', 'Novg', 'Tg', 'Utg', 'Dtg', 'Ttg', 'Qatg', 'Qitg', 'Sxtg', 'Sptg', 'Octg', 'Notg'];

    function formatCurrency(num) {
        if (isNaN(num)) num = 0;
        if (num < 1000000) {
            return `Rp ${Math.floor(num).toLocaleString('id-ID')}`;
        }
        const i = Math.floor(Math.log10(num) / 3);
        if (i < suffixes.length) {
            const scaledNum = num / Math.pow(1000, i);
            const formattedNum = scaledNum.toFixed(2).replace(/\.00$/, '').replace(/\.([1-9])0$/, '.$1');
            return `Rp ${formattedNum} ${suffixes[i]}`;
        }
        return `Rp ${num.toExponential(2)}`;
    }

    // --- STATE MANAGEMENT ---
    function loadState() {
        const savedMoney = localStorage.getItem('idleTycoonMoney');
        const savedBankData = localStorage.getItem('idleTycoonBankData');
        const initialMoney = 100000;

        if (savedMoney) {
            const parsedMoney = parseFloat(savedMoney);
            // If parsing fails (e.g., from an old formatted string with suffixes) or results in NaN, reset to default.
            if (!isNaN(parsedMoney)) {
                money = parsedMoney;
            } else {
                console.warn("Gagal memuat saldo, kembali ke nilai awal.");
                money = initialMoney;
            }
        } else {
            money = initialMoney; // Default for new players
        }

        if (savedBankData) {
            try {
                bankData = JSON.parse(savedBankData);
            } catch (e) {
                console.error("Gagal memuat data bank, mereset data bank.", e);
                bankData = { cards: [] };
            }
        } else {
            bankData = { cards: [] };
        }
        
        if (!bankData || !bankData.cards) bankData = { cards: [] };

        checkForWithdrawals();
        updateUI();
    }

    function saveState() {
        localStorage.setItem('idleTycoonMoney', money.toString());
        localStorage.setItem('idleTycoonBankData', JSON.stringify(bankData));
    }
    
    function showToast(message) {
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.getElementById('toast-container').appendChild(toast);
        
        setTimeout(() => toast.classList.add('show'), 10);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 500);
        }, 3000);
    }

    function checkForWithdrawals() {
        const tycoonWithdrawal = parseFloat(localStorage.getItem('tycoonWithdrawal') || '0');
        if (tycoonWithdrawal > 0) {
            money += tycoonWithdrawal;
            localStorage.setItem('tycoonWithdrawal', '0'); // Reset after claiming
            showToast(`Anda menerima transfer sebesar ${formatCurrency(tycoonWithdrawal)}.`);
            saveState(); // Save immediately after receiving funds
            updateUI();
        }
    }

    // --- RENDER FUNCTIONS ---
    function renderCards() {
        if(!totalInBankEl) return;
        totalInBankEl.textContent = formatCurrency(bankData.cards.reduce((sum, card) => sum + card.balance, 0));
        if (bankData.cards.length === 0) {
            cardListEl.innerHTML = `<p class="text-center text-gray-500">Anda belum punya kartu bank.</p>`;
            return;
        }
        cardListEl.innerHTML = bankData.cards.map((card, index) => `
            <div class="card p-4 rounded-lg shadow-lg">
                <div class="flex justify-between items-center mb-2">
                    <h4 class="font-bold text-lg">${card.name}</h4>
                    <p class="font-mono text-xl">${formatCurrency(card.balance)}</p>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <div>
                         <div class="relative w-full">
                            <input type="number" class="w-full bg-gray-900 p-2 rounded pr-12 text-sm" placeholder="Jumlah Setor" data-action="deposit" data-index="${index}">
                            <button class="card-action-btn-max absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300" data-action="deposit-max" data-index="${index}">MAX</button>
                        </div>
                        <button class="card-action-btn mt-1 w-full bg-green-600 hover:bg-green-700 text-white font-bold py-1 rounded text-sm" data-action="deposit" data-index="${index}">Setor</button>
                    </div>
                    <div>
                        <div class="relative w-full">
                            <input type="number" class="w-full bg-gray-900 p-2 rounded pr-12 text-sm" placeholder="Jumlah Tarik" data-action="withdraw" data-index="${index}">
                            <button class="card-action-btn-max absolute inset-y-0 right-0 px-3 text-sm font-bold text-yellow-400 hover:text-yellow-300" data-action="withdraw-max" data-index="${index}">MAX</button>
                        </div>
                        <button class="card-action-btn mt-1 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-1 rounded text-sm" data-action="withdraw" data-index="${index}">Tarik</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function updateUI() {
        moneyEl.textContent = formatCurrency(money);
        clickValueEl.textContent = formatCurrency(getClickValue());
        updateBalances();
        if(document.getElementById('card-screen').classList.contains('screen') && !document.getElementById('card-screen').classList.contains('hidden')) {
            renderCards();
        }
    }
    
    function updateBalances() {
        const businessData = JSON.parse(localStorage.getItem('businessGameData')) || { balance: 0 };
        if(businessBalanceEl) businessBalanceEl.textContent = formatCurrency(businessData.balance);
        
        const exchangeData = JSON.parse(localStorage.getItem('stockExchangeData')) || { balance: 0 };
        if(exchangeBalanceEl) exchangeBalanceEl.textContent = formatCurrency(exchangeData.balance);

        const tradingData = JSON.parse(localStorage.getItem('tradingPlatformSaveData')) || { balance: 0 };
        if(tradingBalanceEl) tradingBalanceEl.textContent = formatCurrency(tradingData.balance);
        
        const cryptoData = JSON.parse(localStorage.getItem('cryptoExchangeData')) || { balance: 0 };
        if(cryptoBalanceEl) cryptoBalanceEl.textContent = formatCurrency(cryptoData.balance);
    }

    // --- CARD ACTIONS ---
    createCardBtn.addEventListener('click', () => {
        const name = cardNameInput.value.trim();
        if (name) {
            bankData.cards.push({ name: name, balance: 0 });
            cardNameInput.value = '';
            saveState();
            renderCards();
        } else {
            alert("Nama kartu tidak boleh kosong.");
        }
    });

    cardListEl.addEventListener('click', (e) => {
        if (e.target.classList.contains('card-action-btn')) {
            const action = e.target.dataset.action;
            const index = parseInt(e.target.dataset.index);
            const input = cardListEl.querySelector(`input[data-action="${action}"][data-index="${index}"]`);
            const amount = parseFloat(input.value);

            if (isNaN(amount) || amount <= 0) return;

            if (action === 'deposit') {
                if (money >= amount) { money -= amount; bankData.cards[index].balance += amount; } 
                else { alert('Uang tunai tidak cukup!'); }
            } else if (action === 'withdraw') {
                if (bankData.cards[index].balance >= amount) { bankData.cards[index].balance -= amount; money += amount; } 
                else { alert('Saldo kartu tidak cukup!'); }
            }
            input.value = '';
            saveState();
            updateUI();
        }
        if (e.target.classList.contains('card-action-btn-max')) {
            const action = e.target.dataset.action;
            const index = parseInt(e.target.dataset.index);

            if (action === 'deposit-max') {
                const input = cardListEl.querySelector(`input[data-action="deposit"][data-index="${index}"]`);
                input.value = Math.floor(money);
            } else if (action === 'withdraw-max') {
                const input = cardListEl.querySelector(`input[data-action="withdraw"][data-index="${index}"]`);
                input.value = Math.floor(bankData.cards[index].balance);
            }
        }
    });
    
    // --- HUB LOGIC ---
    function setupHub(platform) {
        document.getElementById(`deposit-button-${platform}`).addEventListener('click', () => {
            const amountInput = document.getElementById(`deposit-amount-${platform}`);
            const amount = parseFloat(amountInput.value);
            const storageKeyMap = { business: 'businessGameData', exchange: 'stockExchangeData', trading: 'tradingPlatformSaveData', crypto: 'cryptoExchangeData' };
            const storageKey = storageKeyMap[platform];

            if (isNaN(amount) || amount <= 0 || money < amount) return;
            money -= amount;
            let data = JSON.parse(localStorage.getItem(storageKey)) || { balance: 0 };
            data.balance = (data.balance || 0) + amount;
            localStorage.setItem(storageKey, JSON.stringify(data));
            amountInput.value = '';
            saveState();
            updateUI();
        });

        document.getElementById(`withdraw-button-${platform}`).addEventListener('click', () => {
            const amountInput = document.getElementById(`withdraw-amount-${platform}`);
            const amount = parseFloat(amountInput.value);
            const storageKeyMap = { business: 'businessGameData', exchange: 'stockExchangeData', trading: 'tradingPlatformSaveData', crypto: 'cryptoExchangeData' };
            const storageKey = storageKeyMap[platform];
            let data = JSON.parse(localStorage.getItem(storageKey)) || { balance: 0 };

            if (isNaN(amount) || amount <= 0 || data.balance < amount) return;
            data.balance -= amount;
            money += amount;
            localStorage.setItem(storageKey, JSON.stringify(data));
            amountInput.value = '';
            saveState();
            updateUI();
        });
        
        document.getElementById(`deposit-max-${platform}`).addEventListener('click', () => {
            document.getElementById(`deposit-amount-${platform}`).value = Math.floor(money);
        });

        document.getElementById(`withdraw-max-${platform}`).addEventListener('click', () => {
            const storageKeyMap = { business: 'businessGameData', exchange: 'stockExchangeData', trading: 'tradingPlatformSaveData', crypto: 'cryptoExchangeData' };
            const storageKey = storageKeyMap[platform];
            let data = JSON.parse(localStorage.getItem(storageKey)) || { balance: 0 };
            document.getElementById(`withdraw-amount-${platform}`).value = Math.floor(data.balance);
        });
    }

    // --- NAVIGATION ---
    document.querySelectorAll('.nav-button').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.add('hidden'));
            document.getElementById(button.dataset.screen).classList.remove('hidden');
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            updateUI();
        });
    });

    // --- INITIALIZATION ---
    window.addEventListener('focus', loadState);
    loadState();
    setInterval(saveState, 5000);
    
    function getClickValue() { return 100; }
    function getActiveUpgrades() { return {}; }

    clickButton.addEventListener('click', () => {
        money += getClickValue();
        updateUI();
    });

    setupHub('business');
    setupHub('exchange');
    setupHub('trading');
    setupHub('crypto');

    // --- Force links to open in the same tab ---
    document.querySelectorAll('a[href$=".html"]').forEach(link => {
        link.addEventListener('click', function(event) {
            event.preventDefault();
            window.location.href = this.getAttribute('href');
        });
    });
    </script>
</body>
</html>


